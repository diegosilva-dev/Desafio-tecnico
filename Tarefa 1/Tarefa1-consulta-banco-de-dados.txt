WITH CTE AS (
    SELECT
        p.Nome AS Pessoa,
        p.Salario,
        d.Nome AS Departamento,
        DENSE_RANK() OVER (
            PARTITION BY p.DeptId 
            ORDER BY p.Salario DESC
        ) AS rk
    FROM Pessoa p
    JOIN Departamento d ON d.Id = p.DeptId
)
SELECT Departamento, Pessoa, Salario
FROM CTE
WHERE rk = 1;